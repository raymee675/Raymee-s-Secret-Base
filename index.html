<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>レイミーの秘密基地</title>
    <meta name="description" content="絵描きだとかプログラミングだとのよしなしごとをまとめるサイトでございます。知的好奇心と時間が有り余っている方にぜひ読んでいただきたいです。" />
    <meta name="keywords" content="レイミーの秘密基地" />
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/raymee675/Raymee-s-Secret-Base@latest/data/Resources/favicon.png" />
    <!-- Load stylesheet and favicon from CDN first; if blocked (Tracking Prevention)
         or failing to load, fall back to local copies. Meta tags above are preserved. -->
    <script src="https://cdn.jsdelivr.net/gh/raymee675/Raymee-s-Secret-Base@latest/script.js">
      /*
      (function () {
        var cdnBase = 'https://cdn.jsdelivr.net/gh/raymee675/Raymee-s-Secret-Base@latest';
        var cdnCss = cdnBase + '/style.css';
        var localCss = 'style.css';

        function loadCss(href) {
          var l = document.createElement('link');
          l.rel = 'stylesheet';
          l.href = href;
          document.head.appendChild(l);
          return l;
        }

        // Try CDN first, then fallback to local on error
        var cssLink = loadCss(cdnCss);
        cssLink.onerror = function () {
          // Remove the failed CDN link then load local
          try { document.head.removeChild(cssLink); } catch (e) {}
          loadCss(localCss);
        };

        // Favicon: similar approach
        var cdnFavicon = cdnBase + '/data/Resources/favicon.png';
        var localFavicon = 'data/Resources/favicon.png';
        function loadIcon(href) {
          var i = document.createElement('link');
          i.rel = 'icon';
          i.href = href;
          document.head.appendChild(i);
          return i;
        }
        var iconLink = loadIcon(cdnFavicon);
        iconLink.onerror = function () {
          try { document.head.removeChild(iconLink); } catch (e) {}
          loadIcon(localFavicon);
        };
      })();
      */
    </script>
  </head>

  <body>
    <main>
      <div class="container layout">
        <aside id="sidebar" class="card">
          <div class="sidebar-inner">
            <div class="sidebar-header">
              <button
                id="sidebarToggle"
                class="btn btn-ghost"
                aria-label="Toggle menu"
              >
                ☰
              </button>
            </div>
            <ul class="menu" id="menuList">
              <li class="menu-item" data-url="index.html" data-content="ホーム">
                <span class="icon"><img src="data/Resources/Home.png" alt="Home" style="width: 20px; height: 20px;" /></span><span class="label">Home</span>
              </li>

              <li class="menu-item" data-url="data/BlogData/Rules/Rules.html" data-content="ルール">
                <span class="icon"><img src="data/Resources/Rules.png" alt="Rules" style="width: 20px; height: 20px;" /></span><span class="label">Rules</span>
              </li>

              <li class="menu-item" data-url="template.html" data-content="ドキュメント">
                <span class="icon"><img src="data/Resources/Documents.png" alt="Documents" style="width: 20px; height: 20px;" /></span><span class="label">Documents</span>
              </li>
            </ul>
          </div>
        </aside>

        <section id="mainArea">
          <div id="contentArea">
            <div class="card">
              <div class="card-header">
                <div class="card-title">レイミーの秘密基地へ、ようこそ</div>
              </div>
              <div class="card-sub">
                絵描きだとかプログラミングだとのよしなしごとをまとめるサイトでございます。<br>
                知的好奇心と時間が有り余っている方にぜひ<br>
                Twitter に上げた絵とか、DTM で作った曲とかの創作作品を気まぐれで投稿します。<br>
            </div>

            <br>

            <div id="BlogList" class="card blog-list">
              <div class="card-header">
                <div class="card-title">Blog Posts</div>
              </div>
              <div class="blog-list-items" aria-live="polite">
                <!-- posts.json を読み込んでここに一覧を挿入します -->
              </div>
              <div class="blog-pagination" style="text-align: center; padding-top: 20px; border-top: 1px solid #ddd; margin-top: 20px;">
                <button id="loadMoreButton" class="btn btn-primary" style="display: none;">過去のブログを読み込む</button>
                <div id="paginationInfo" class="muted small" style="margin-top: 10px;"></div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
    <!-- Load main script: try local first, fall back to CDN if local fails. -->
    <script>
      (function () {
        var local = 'script.js';
        var cdn = 'https://cdn.jsdelivr.net/gh/raymee675/Raymee-s-Secret-Base@latest/script.js';

        function loadScript(src, onload, onerror) {
          var s = document.createElement('script');
          s.src = src;
          s.defer = true;
          if (onload) s.onload = onload;
          if (onerror) s.onerror = onerror;
          document.body.appendChild(s);
          return s;
        }

        // Load local first; if it errors (blocked/missing), try CDN.
        var sLocal = loadScript(local, null, function () {
          try { document.body.removeChild(sLocal); } catch (e) {}
          loadScript(cdn);
        });
      })();
    </script>
  </body>
</html>
